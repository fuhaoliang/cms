(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-666f"],{BQWJ:function(e,t,a){},INj8:function(e,t,a){"use strict";var i=a("BQWJ");a.n(i).a},gFdR:function(e,t,a){},tP62:function(e,t,a){"use strict";var i=a("gFdR");a.n(i).a},ygPO:function(e,t,a){"use strict";a.r(t);var i=a("bS4n"),n=a.n(i),l=a("cLjf"),r=a.n(l),s=a("hDQ3"),o=a.n(s),c=a("3Aqr"),u=a.n(c),m=a("Fc76"),p=(a("ArKu"),a("oXXQ"),a("b6CF"),a("vsxl"),a("gA3L"),a("If1e"),a("CixU"),a("icwO"),a("c/YV"),a("bdLP"),a("mUAK"),a("+n12")),b=a("dRp0"),d={components:{Editor:m.a},props:{value:{type:String,default:""},disabled:{type:Boolean,default:!1},plugins:{type:[String,Array],default:"lists image imagetools media table textcolor wordcount contextmenu code"},toolbar:{type:[String,Array],default:"code | undo redo |  formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | lists image media table | removeformat"}},data:function(){var e=this;return{init:{language_url:"../../static/tinymce/langs/zh_CN.js",language:"zh_CN",skin_url:"../../static/tinymce/skins/lightgray",height:420,plugins:this.plugins,toolbar:this.toolbar,branding:!1,menubar:!1,automatic_uploads:!1,image_title:!0,image_advtab:!0,images_reuse_filename:!0,imagetools_toolbar:"rotateleft rotateright | flipv fliph | editimage imageoptions",images_upload_handler:function(){var t=o()(r.a.mark(function t(a,i,n){var l,s,o,c,u,m,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l="data:image/jpeg;base64,"+a.base64(),s=a.name(),o=p.a.dataURLtoFile(l,s),(c=new FormData).append("file",o),e.next=7,b.a.userApi.uploadImage(c);case 7:u=e.sent,m=u.status,d=u.data,0===m.code&&i(d.file),-1===m.code&&n(m.message);case 12:case"end":return e.stop()}},t,e)}));return function(e,a,i){return t.apply(this,arguments)}}()},myValue:this.value}},watch:{value:function(e){this.myValue=e},myValue:function(e){this.$emit("input",e)}},mounted:function(){u.a.init({})},methods:{onClick:function(e){this.$emit("onClick",e,u.a)},clear:function(){this.myValue=""}}},g=(a("INj8"),a("ZrdR")),f=Object(g.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tinymce-editor"},[a("editor",{attrs:{init:e.init,disabled:e.disabled},model:{value:e.myValue,callback:function(t){e.myValue=t},expression:"myValue"}})],1)},[],!1,null,"26968721",null);f.options.__file="tinymce-editor.vue";var v={components:{TinymceEditor:f.exports},data:function(){return{dbTagArr:[],blogObj:{title:"",content:"",articleLink:"",isComment:!0,timeDateType:"1",timeDate:0,tagArr:[],public:0},disabled:!1,id:""}},watch:{"blogObj.timeDateType":{handler:function(e){"1"===e&&(this.blogObj.timeDate=(new Date).getTime())},immediate:!0},"$route.query":{handler:function(e){var t=e.id;this.id=t},immediate:!0}},mounted:function(){var e=this;return o()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,t.next=3,e.getTags();case 3:if(!a){t.next=6;break}return t.next=6,e.getArticle(a);case 6:p.a.copyData([{name:"blogObj",value:e.blogObj}]);case 7:case"end":return t.stop()}},t,e)}))()},methods:{onClick:function(e,t){console.log("Element clicked"),console.log(e),console.log(t)},clear:function(){this.$refs.editor.clear()},close:function(){this.$router.push("/article/all-article")},getArticle:function(e){var t=this;return o()(r.a.mark(function a(){var i,n,l;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.a.articleApi.getAtricleInfo({id:e});case 2:i=a.sent,n=i.status,l=i.data,0===n.code?t.blogObj=l.articleObj:-1===n.code&&t.$message.error(n.message);case 6:case"end":return a.stop()}},a,t)}))()},publicArticle:function(){var e=this;return o()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.blogObj.public=1,e.saveArticle("发布成功");case 2:case"end":return t.stop()}},t,e)}))()},privateArticle:function(){var e=this;return o()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.blogObj.public=0,e.saveArticle("下架成功");case 2:case"end":return t.stop()}},t,e)}))()},saveArticle:function(e){var t=this;return o()(r.a.mark(function a(){var i,l,s,o,c,u,m,d,g;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i=t.blogObj,l=t.id,e=e||"保存成功",console.info("msg"),!l){a.next=16;break}if(0!==(s=p.a.compareData({name:"blogObj",value:i},!0)).length){a.next=7;break}return a.abrupt("return",t.$message.error("未修改内容"));case 7:return o={},s.forEach(function(e){return o[e]=i[e]}),a.next=11,b.a.articleApi.patchAtricle(n()({id:l},o));case 11:c=a.sent,0===(u=c.status).code?(t.$message.success(e),p.a.copyData([{name:"blogObj",value:i}])):-1===u.code&&t.$message.error(u.message),a.next=22;break;case 16:return a.next=18,b.a.articleApi.addAtricle(n()({},i));case 18:m=a.sent,d=m.status,g=m.data,0===d.code?(t.$message.success(e),t.$router.replace({path:"write-article",query:{id:g.id}}),p.a.copyData([{name:"blogObj",value:i}])):-1===d.code&&t.$message.error(d.message);case 22:case"end":return a.stop()}},a,t)}))()},getTags:function(){var e=this;return o()(r.a.mark(function t(){var a,i,n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.a.articleApi.getTags();case 2:a=t.sent,i=a.status,n=a.data,0===i.code&&(e.dbTagArr=n.tagArr);case 6:case"end":return t.stop()}},t,e)}))()}}},h=(a("tP62"),Object(g.a)(v,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"writeArticle",staticClass:"dashboard-container",attrs:{model:e.blogObj}},[a("div",{staticClass:"writeArite-header"},[a("div",{staticClass:"writeArite-header-l"},[a("el-input",{attrs:{placeholder:"请输入",size:"medium"},model:{value:e.blogObj.title,callback:function(t){e.$set(e.blogObj,"title",t)},expression:"blogObj.title"}},[a("template",{slot:"prepend"},[e._v("博客标题:")])],2)],1),e._v(" "),a("div",{staticClass:"writeArite-header-r"},[0===e.blogObj.public?a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){e.publicArticle()}}},[e._v("发布")]):a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){e.privateArticle()}}},[e._v("下架")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){e.saveArticle()}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",plain:""}},[e._v("预览")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){e.close()}}},[e._v("关闭")])],1)]),e._v(" "),a("div",{staticClass:"writeArticle-content"},[a("tinymce-editor",{ref:"editor",staticClass:"editor",attrs:{disabled:e.disabled},on:{onClick:e.onClick},model:{value:e.blogObj.content,callback:function(t){e.$set(e.blogObj,"content",t)},expression:"blogObj.content"}}),e._v(" "),a("el-collapse",{staticClass:"article-set",attrs:{accordion:""}},[a("el-collapse-item",[a("template",{slot:"title"},[a("span",{staticClass:"svg-container"},[a("svg-icon",{attrs:{"icon-class":"biaoqian"}}),e._v("标签\n          ")],1)]),e._v(" "),a("el-select",{staticClass:"tags-select",attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签"},model:{value:e.blogObj.tagArr,callback:function(t){e.$set(e.blogObj,"tagArr",t)},expression:"blogObj.tagArr"}},e._l(e.dbTagArr,function(e){return a("el-option",{key:e.id,attrs:{label:e.tagName,value:e.tagName}})}))],2),e._v(" "),a("el-collapse-item",[a("template",{slot:"title"},[a("span",{staticClass:"svg-container"},[a("svg-icon",{attrs:{"icon-class":"shijian"}}),e._v("安排\n          ")],1)]),e._v(" "),a("el-radio",{attrs:{label:"1"},model:{value:e.blogObj.timeDateType,callback:function(t){e.$set(e.blogObj,"timeDateType",t)},expression:"blogObj.timeDateType"}},[e._v("自动")]),e._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:e.blogObj.timeDateType,callback:function(t){e.$set(e.blogObj,"timeDateType",t)},expression:"blogObj.timeDateType"}},[a("el-date-picker",{staticClass:"date-input",attrs:{"prefix-icon":"no-icon",type:"datetime","value-format":"timestamp",placeholder:"设置日期"},model:{value:e.blogObj.timeDate,callback:function(t){e.$set(e.blogObj,"timeDate",t)},expression:"blogObj.timeDate"}})],1)],2),e._v(" "),a("el-collapse-item",[a("template",{slot:"title"},[a("span",{staticClass:"svg-container"},[a("svg-icon",{attrs:{"icon-class":"lianjie"}}),e._v("固定连接\n          ")],1)]),e._v(" "),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.blogObj.articleLink,callback:function(t){e.$set(e.blogObj,"articleLink",t)},expression:"blogObj.articleLink"}},[a("template",{slot:"append"},[e._v(".html")])],2)],2),e._v(" "),a("el-collapse-item",[a("template",{slot:"title"},[a("span",{staticClass:"svg-container"},[a("svg-icon",{attrs:{"icon-class":"shezhi"}}),e._v("选项\n          ")],1)]),e._v(" "),a("div",{staticClass:"comment-box"},[e._v("\n          读者评论：\n          "),a("el-switch",{attrs:{"active-text":"允许","inactive-text":"不允许"},model:{value:e.blogObj.isComment,callback:function(t){e.$set(e.blogObj,"isComment",t)},expression:"blogObj.isComment"}})],1)],2)],1)],1)])},[],!1,null,"3075e0a6",null));h.options.__file="writeArticle.vue";t.default=h.exports}}]);